<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://java.sun.com/jsf/html"
       xmlns:ui="http://java.sun.com/jsf/facelets"
       xmlns:f="http://xmlns.jcp.org/jsf/core"
       xmlns:b="http://bootsfaces.net/ui">
<h:head>
	
	<h:outputScript library="defecto" name="js/jquery-1.8.0.min.js" target="head"/>
	
	<!-- Google Maps -->
	<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
	
    <script src="http://openlayers.org/api/OpenLayers.js"></script>
    
    <h:outputScript library="defecto" name="js/Variables.js" target="head"/>
  
	<h:outputScript target="head">
	

	
	 window.onload = function() {
	
		   
		var WGS84 = new OpenLayers.Projection(miEPSG);
		var WGS84_google_mercator = new OpenLayers.Projection(gEPSG);		
		
		var limites = new OpenLayers.Bounds(
			366582.290141166, 6127927.10038269,
			858252.0151745,6671738.21181725
		);
		

		var opciones = {
			controls : [ new OpenLayers.Control.Navigation(),
				new OpenLayers.Control.PanZoom(),
				new OpenLayers.Control.LayerSwitcher(),
				new OpenLayers.Control.MousePosition({
					div : document.getElementById("coordinates")
				}) ],
			maxExtent: limites,
			displayProjection: WGS84,
			projection: WGS84
		};
	
	
		/* "Map Constructor"
		Crea un mapa en el bloque con id "map"  
		*/
		var map = new OpenLayers.Map('map', opciones);	
		
		alert(map.getProjection());
				
		var google_maps = new OpenLayers.Layer.Google("Google Maps", {
			numZoomLevels : 20
		});
		
		var gphy = new OpenLayers.Layer.Google("Google Physical", {
		type : googleTerreno
		});		
				
		
		/* "Layer Constructor"
		 Agrega capas al mapa, pidiendo la misma por medio de una llamada Web Map Service 
	    */
		var wms = new OpenLayers.Layer.WMS( "Departamentos",
									   		 urlWMS,
									   		 {'layers':'sige:00departamento'} );	
									    
									    
		map.addLayers([ google_maps, gphy, wms ]);
		map.zoomToExtent(limites);				    
			
		/// PARA CENTRAR EN URUGUAY
		var center = new OpenLayers.LonLat(miLongitud, miLatitud).transform(
					new OpenLayers.Projection(miEPSG), map.getProjectionObject());
					
		map.setCenter(center, miZoom + 3);
			
		var marca = new OpenLayers.Layer.Markers("Marcas");
		marca.id = "Marcas";
		map.addLayer(marca);
		
		var apreto = false;
		
		map.events.register("click", map, function(e) {
		    if(apreto){
		      // map.getLayer('Marcas').clearMarkers();
		    	marca.clearMarkers();
		    }
		    
		      //var posicion = this.events.getMousePosition(e);
		      var posicion = map.getLonLatFromPixel(e.xy);
		      var tama単o = new OpenLayers.Size(21,25);
		 	  var offset = new OpenLayers.Pixel(-(tama単o.w/2), -tama単o.h);
		 	  var icono = new OpenLayers.Icon('http://maps.google.com/mapfiles/ms/icons/red-pushpin.png', tama単o, offset);   
		 	  var capaMarca = map.getLayer('Marcas');
		
			  capaMarca.addMarker(new OpenLayers.Marker(posicion,icono));
			  alert(posicion);
			  apreto = true;
				
	   });
	 
	  };
	
	</h:outputScript>
	
	
</h:head>

<h:body>      
      
     
    	<b:navbarLinks>
        <b:navLink value="Administradores" href="http://localhost:8080/Inmo13/faces/Login.xhtml"></b:navLink>
  	  </b:navbarLinks>
	

</h:body>


<!--  
	Bootfaces hace unos conflictos cuando usas el tag <script src="...".. entonces lo saque porque no
			 andaba el mapa, ver esto despues
			 
			 
       xmlns:b="http://bootsfaces.net/ui"
-->
		<!-- Mapa -->
	   <div style="width:100%; height:100%" id="map"></div>
	   
	   
		<div id="coordinates"></div>
		
<h:panelGroup layout="block" id="div-bootfaces">

	
  <b:button outcome="testButton" value="Bookmark" icon="bookmark">  
        <f:param name="testId" value="11" />  
    </b:button>  
</h:panelGroup>
</html>
